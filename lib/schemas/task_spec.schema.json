{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://light-agentic-agent/schemas/task_spec.schema.json",
  "title": "TaskSpec",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "task_id",
    "title",
    "description",
    "objective",
    "acceptance_criteria",
    "risk_level",
    "budget",
    "tools",
    "skills"
  ],
  "properties": {
    "task_id": { "type": "string", "minLength": 3 },
    "title": { "type": "string", "minLength": 3 },
    "description": { "type": "string", "minLength": 10 },
    "objective": { "type": "string", "minLength": 10 },
    "context": { "type": "string" },
    "acceptance_criteria": {
      "type": "array",
      "minItems": 1,
      "items": { "type": "string", "minLength": 3 }
    },
    "risk_level": {
      "type": "string",
      "enum": ["low", "medium", "high"]
    },
    "budget": {
      "type": "object",
      "additionalProperties": false,
      "required": ["max_usd", "max_input_tokens", "max_output_tokens"],
      "properties": {
        "max_usd": { "type": "number", "minimum": 0.01, "maximum": 5 },
        "max_input_tokens": { "type": "integer", "minimum": 256, "maximum": 200000 },
        "max_output_tokens": { "type": "integer", "minimum": 128, "maximum": 200000 }
      }
    },
    "tools": {
      "type": "object",
      "additionalProperties": false,
      "required": ["mcp"],
      "properties": {
        "mcp": {
          "type": "object",
          "additionalProperties": false,
          "required": ["allow"],
          "properties": {
            "allow": {
              "type": "array",
              "uniqueItems": true,
              "items": { "type": "string", "pattern": "^[a-zA-Z0-9_.:-]+$" }
            }
          }
        }
      }
    },
    "skills": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["skill_id", "prompt", "tools_allowed"],
        "properties": {
          "skill_id": { "type": "string", "minLength": 2 },
          "prompt": { "type": "string", "minLength": 3 },
          "tools_allowed": {
            "type": "array",
            "uniqueItems": true,
            "items": { "type": "string", "pattern": "^[a-zA-Z0-9_.:-]+$" }
          }
        }
      }
    },
    "metadata": {
      "type": "object",
      "additionalProperties": {
        "type": ["string", "number", "boolean", "null"]
      }
    }
  }
}
